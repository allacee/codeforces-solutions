Пояснения к примененному алгоритму:
Идея задачи похожа на задачу 1450. Принципиальное отличие состоит в том, что при определении максимума требуется так же учитывать коммиссию за обмен.
Использовался алгоритм Беллмана-Форда.